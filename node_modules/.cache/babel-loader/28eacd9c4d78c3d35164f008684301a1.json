{"ast":null,"code":"var _jsxFileName = \"/home/fazal/Documents/reactjs/inbox-pivot/src/App.js\";\nimport React from 'react';\nimport logo from \"./logo.svg\";\nimport './App.css';\nimport * as d3 from 'd3';\nimport miserableJSON from '../src/miserables.json';\nconst jsondata = miserableJSON;\n\nfunction App() {\n  var width = 800;\n  var height = 600;\n  var color = d3.scaleOrdinal(d3.schemeCategory10);\n  var label = {\n    'nodes': [],\n    'links': []\n  };\n  jsondata.nodes.forEach(function (d, i) {\n    label.nodes.push({\n      node: d\n    });\n    label.nodes.push({\n      node: d\n    });\n    label.links.push({\n      source: i * 2,\n      target: i * 2 + 1\n    });\n  });\n  var labelLayout = d3.forceSimulation(label.nodes).force(\"charge\", d3.forceManyBody().strength(-50)).force(\"link\", d3.forceLink(label.links).distance(0).strength(2));\n  var graphLayout = d3.forceSimulation(jsondata.nodes).force(\"charge\", d3.forceManyBody().strength(-3000)).force(\"center\", d3.forceCenter(width / 2, height / 2)).force(\"x\", d3.forceX(width / 2).strength(1)).force(\"y\", d3.forceY(height / 2).strength(1)).force(\"link\", d3.forceLink(jsondata.links).id(function (d) {\n    return d.id;\n  }).distance(50).strength(1)).on(\"tick\", ticked);\n  var adjlist = [];\n  jsondata.links.forEach(function (d) {\n    adjlist[d.source.index + \"-\" + d.target.index] = true;\n    adjlist[d.target.index + \"-\" + d.source.index] = true;\n  });\n\n  function neigh(a, b) {\n    return a == b || adjlist[a + \"-\" + b];\n  }\n\n  var svg = d3.select(\"#viz\").attr(\"width\", width).attr(\"height\", height);\n  var container = svg.append(\"g\");\n  svg.call(d3.zoom().scaleExtent([.1, 4]).on(\"zoom\", function () {\n    container.attr(\"transform\", d3.event.transform);\n  }));\n  var link = container.append(\"g\").attr(\"class\", \"links\").selectAll(\"line\").data(graph.links).enter().append(\"line\").attr(\"stroke\", \"#aaa\").attr(\"stroke-width\", \"1px\");\n  var node = container.append(\"g\").attr(\"class\", \"nodes\").selectAll(\"g\").data(graph.nodes).enter().append(\"circle\").attr(\"r\", 5).attr(\"fill\", function (d) {\n    return color(d.group);\n  });\n  node.on(\"mouseover\", focus).on(\"mouseout\", unfocus);\n  node.call(d3.drag().on(\"start\", dragstarted).on(\"drag\", dragged).on(\"end\", dragended));\n  var labelNode = container.append(\"g\").attr(\"class\", \"labelNodes\").selectAll(\"text\").data(label.nodes).enter().append(\"text\").text(function (d, i) {\n    return i % 2 == 0 ? \"\" : d.node.id;\n  }).style(\"fill\", \"#555\").style(\"font-family\", \"Arial\").style(\"font-size\", 12).style(\"pointer-events\", \"none\"); // to prevent mouseover/drag capture\n\n  node.on(\"mouseover\", focus).on(\"mouseout\", unfocus);\n\n  function ticked() {\n    node.call(updateNode);\n    link.call(updateLink);\n    labelLayout.alphaTarget(0.3).restart();\n    labelNode.each(function (d, i) {\n      if (i % 2 == 0) {\n        d.x = d.node.x;\n        d.y = d.node.y;\n      } else {\n        var b = this.getBBox();\n        var diffX = d.x - d.node.x;\n        var diffY = d.y - d.node.y;\n        var dist = Math.sqrt(diffX * diffX + diffY * diffY);\n        var shiftX = b.width * (diffX - dist) / (dist * 2);\n        shiftX = Math.max(-b.width, Math.min(0, shiftX));\n        var shiftY = 16;\n        this.setAttribute(\"transform\", \"translate(\" + shiftX + \",\" + shiftY + \")\");\n      }\n    });\n    labelNode.call(updateNode);\n  }\n\n  function fixna(x) {\n    if (isFinite(x)) return x;\n    return 0;\n  }\n\n  function focus(d) {\n    var index = d3.select(d3.event.target).datum().index;\n    node.style(\"opacity\", function (o) {\n      return neigh(index, o.index) ? 1 : 0.1;\n    });\n    labelNode.attr(\"display\", function (o) {\n      return neigh(index, o.node.index) ? \"block\" : \"none\";\n    });\n    link.style(\"opacity\", function (o) {\n      return o.source.index == index || o.target.index == index ? 1 : 0.1;\n    });\n  }\n\n  function unfocus() {\n    labelNode.attr(\"display\", \"block\");\n    node.style(\"opacity\", 1);\n    link.style(\"opacity\", 1);\n  }\n\n  function updateLink(link) {\n    link.attr(\"x1\", function (d) {\n      return fixna(d.source.x);\n    }).attr(\"y1\", function (d) {\n      return fixna(d.source.y);\n    }).attr(\"x2\", function (d) {\n      return fixna(d.target.x);\n    }).attr(\"y2\", function (d) {\n      return fixna(d.target.y);\n    });\n  }\n\n  function updateNode(node) {\n    node.attr(\"transform\", function (d) {\n      return \"translate(\" + fixna(d.x) + \",\" + fixna(d.y) + \")\";\n    });\n  }\n\n  function dragstarted(d) {\n    d3.event.sourceEvent.stopPropagation();\n    if (!d3.event.active) graphLayout.alphaTarget(0.3).restart();\n    d.fx = d.x;\n    d.fy = d.y;\n  }\n\n  function dragged(d) {\n    d.fx = d3.event.x;\n    d.fy = d3.event.y;\n  }\n\n  function dragended(d) {\n    if (!d3.event.active) graphLayout.alphaTarget(0);\n    d.fx = null;\n    d.fy = null;\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    id: \"viz\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }\n  }));\n}\n\nexport default App;","map":{"version":3,"sources":["/home/fazal/Documents/reactjs/inbox-pivot/src/App.js"],"names":["React","d3","miserableJSON","jsondata","App","width","height","color","scaleOrdinal","schemeCategory10","label","nodes","forEach","d","i","push","node","links","source","target","labelLayout","forceSimulation","force","forceManyBody","strength","forceLink","distance","graphLayout","forceCenter","forceX","forceY","id","on","ticked","adjlist","index","neigh","a","b","svg","select","attr","container","append","call","zoom","scaleExtent","event","transform","link","selectAll","data","graph","enter","group","focus","unfocus","drag","dragstarted","dragged","dragended","labelNode","text","style","updateNode","updateLink","alphaTarget","restart","each","x","y","getBBox","diffX","diffY","dist","Math","sqrt","shiftX","max","min","shiftY","setAttribute","fixna","isFinite","datum","o","sourceEvent","stopPropagation","active","fx","fy"],"mappings":"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","sourcesContent":["import React from 'react';\nimport logo from './logo.svg';\nimport './App.css';\n\nimport * as d3 from 'd3';\n\nimport miserableJSON from '../src/miserables.json';\n\nconst jsondata = miserableJSON;\n\nfunction App() {\n\n\n  var width = 800;\n  var height = 600;\n  var color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    var label = {\n      'nodes': [],\n      'links': []\n    };\n\n    jsondata.nodes.forEach(function (d, i) {\n      label.nodes.push({ node: d });\n      label.nodes.push({ node: d });\n      label.links.push({\n        source: i * 2,\n        target: i * 2 + 1\n      });\n    });\n\n    var labelLayout = d3.forceSimulation(label.nodes)\n      .force(\"charge\", d3.forceManyBody().strength(-50))\n      .force(\"link\", d3.forceLink(label.links).distance(0).strength(2));\n\n    var graphLayout = d3.forceSimulation(jsondata.nodes)\n      .force(\"charge\", d3.forceManyBody().strength(-3000))\n      .force(\"center\", d3.forceCenter(width / 2, height / 2))\n      .force(\"x\", d3.forceX(width / 2).strength(1))\n      .force(\"y\", d3.forceY(height / 2).strength(1))\n      .force(\"link\", d3.forceLink(jsondata.links).id(function (d) { return d.id; }).distance(50).strength(1))\n      .on(\"tick\", ticked);\n\n    var adjlist = [];\n\n    jsondata.links.forEach(function (d) {\n      adjlist[d.source.index + \"-\" + d.target.index] = true;\n      adjlist[d.target.index + \"-\" + d.source.index] = true;\n    });\n\n    function neigh(a, b) {\n      return a == b || adjlist[a + \"-\" + b];\n    }\n\n\n    var svg = d3.select(\"#viz\").attr(\"width\", width).attr(\"height\", height);\n    var container = svg.append(\"g\");\n\n    svg.call(\n      d3.zoom()\n        .scaleExtent([.1, 4])\n        .on(\"zoom\", function () { container.attr(\"transform\", d3.event.transform); })\n    );\n\n    var link = container.append(\"g\").attr(\"class\", \"links\")\n      .selectAll(\"line\")\n      .data(graph.links)\n      .enter()\n      .append(\"line\")\n      .attr(\"stroke\", \"#aaa\")\n      .attr(\"stroke-width\", \"1px\");\n\n    var node = container.append(\"g\").attr(\"class\", \"nodes\")\n      .selectAll(\"g\")\n      .data(graph.nodes)\n      .enter()\n      .append(\"circle\")\n      .attr(\"r\", 5)\n      .attr(\"fill\", function (d) { return color(d.group); })\n\n    node.on(\"mouseover\", focus).on(\"mouseout\", unfocus);\n\n    node.call(\n      d3.drag()\n        .on(\"start\", dragstarted)\n        .on(\"drag\", dragged)\n        .on(\"end\", dragended)\n    );\n\n    var labelNode = container.append(\"g\").attr(\"class\", \"labelNodes\")\n      .selectAll(\"text\")\n      .data(label.nodes)\n      .enter()\n      .append(\"text\")\n      .text(function (d, i) { return i % 2 == 0 ? \"\" : d.node.id; })\n      .style(\"fill\", \"#555\")\n      .style(\"font-family\", \"Arial\")\n      .style(\"font-size\", 12)\n      .style(\"pointer-events\", \"none\"); // to prevent mouseover/drag capture\n\n    node.on(\"mouseover\", focus).on(\"mouseout\", unfocus);\n\n    function ticked() {\n\n      node.call(updateNode);\n      link.call(updateLink);\n\n      labelLayout.alphaTarget(0.3).restart();\n      labelNode.each(function (d, i) {\n        if (i % 2 == 0) {\n          d.x = d.node.x;\n          d.y = d.node.y;\n        } else {\n          var b = this.getBBox();\n\n          var diffX = d.x - d.node.x;\n          var diffY = d.y - d.node.y;\n\n          var dist = Math.sqrt(diffX * diffX + diffY * diffY);\n\n          var shiftX = b.width * (diffX - dist) / (dist * 2);\n          shiftX = Math.max(-b.width, Math.min(0, shiftX));\n          var shiftY = 16;\n          this.setAttribute(\"transform\", \"translate(\" + shiftX + \",\" + shiftY + \")\");\n        }\n      });\n      labelNode.call(updateNode);\n\n    }\n\n    function fixna(x) {\n      if (isFinite(x)) return x;\n      return 0;\n    }\n\n    function focus(d) {\n      var index = d3.select(d3.event.target).datum().index;\n      node.style(\"opacity\", function (o) {\n        return neigh(index, o.index) ? 1 : 0.1;\n      });\n      labelNode.attr(\"display\", function (o) {\n        return neigh(index, o.node.index) ? \"block\" : \"none\";\n      });\n      link.style(\"opacity\", function (o) {\n        return o.source.index == index || o.target.index == index ? 1 : 0.1;\n      });\n    }\n\n    function unfocus() {\n      labelNode.attr(\"display\", \"block\");\n      node.style(\"opacity\", 1);\n      link.style(\"opacity\", 1);\n    }\n\n    function updateLink(link) {\n      link.attr(\"x1\", function (d) { return fixna(d.source.x); })\n        .attr(\"y1\", function (d) { return fixna(d.source.y); })\n        .attr(\"x2\", function (d) { return fixna(d.target.x); })\n        .attr(\"y2\", function (d) { return fixna(d.target.y); });\n    }\n\n    function updateNode(node) {\n      node.attr(\"transform\", function (d) {\n        return \"translate(\" + fixna(d.x) + \",\" + fixna(d.y) + \")\";\n      });\n    }\n\n    function dragstarted(d) {\n      d3.event.sourceEvent.stopPropagation();\n      if (!d3.event.active) graphLayout.alphaTarget(0.3).restart();\n      d.fx = d.x;\n      d.fy = d.y;\n    }\n\n    function dragged(d) {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    }\n\n    function dragended(d) {\n      if (!d3.event.active) graphLayout.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    }\n\n\n\n\n  return (\n    <div className=\"App\">\n      <svg id='viz'></svg>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}