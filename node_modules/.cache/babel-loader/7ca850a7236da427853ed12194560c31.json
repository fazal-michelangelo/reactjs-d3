{"ast":null,"code":"var _jsxFileName = \"/home/fazal/Documents/claudius/D3-charts/src/LollipopChart6.js\";\nimport React, { useRef, useEffect } from 'react';\nimport * as d3 from 'd3';\nimport { lab } from 'd3';\n\nconst moment = require('moment');\n\nconst PerfectTimeline = props => {\n  useEffect(() => {\n    drawChart();\n  });\n\n  function drawChart() {\n    var margin = {\n      top: 20,\n      right: 20,\n      bottom: 90,\n      left: 50\n    },\n        margin2 = {\n      top: 230,\n      right: 20,\n      bottom: 30,\n      left: 50\n    },\n        width = 960 - margin.left - margin.right,\n        height = 300 - margin.top - margin.bottom,\n        height2 = 300 - margin2.top - margin2.bottom;\n    var parseTime = d3.timeParse(\"%Y-%m-%d\");\n    var x = d3.scaleTime().range([0, width]),\n        x2 = d3.scaleTime().range([0, width]),\n        y = d3.scaleLinear().range([height, 0]),\n        y2 = d3.scaleLinear().range([height2, 0]);\n    var xAxis = d3.axisBottom(x).tickSize(0),\n        xAxis2 = d3.axisBottom(x2).tickSize(0),\n        yAxis = d3.axisLeft(y).tickSize(0);\n    var brush = d3.brushX().extent([[0, 0], [width, height]]).on(\"brush\", brushed);\n    var zoom = d3.zoom().scaleExtent([1, Infinity]).translateExtent([[0, 0], [width, height]]).extent([[0, 0], [width, height]]).on(\"zoom\", zoomed);\n    var svg = d3.select(d3Container.current).append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom);\n    svg.append(\"defs\").append(\"clipPath\").attr(\"id\", \"clip\").append(\"rect\").attr(\"width\", width).attr(\"height\", height);\n    var focus = svg.append(\"g\").attr(\"class\", \"focus\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    var context = svg.append(\"g\").attr(\"class\", \"context\").attr(\"transform\", \"translate(\" + margin2.left + \",\" + margin2.top + \")\");\n    var count = 'count';\n    var xLable = 'timestamp';\n    var textVal = 'label';\n    var data = [{\n      \"timestamp\": \"2010-10-20\",\n      \"count\": 62,\n      \"event\": [{\n        'evetType': 'this is the first event'\n      }, {\n        'evetType': 'second event is printed here'\n      }],\n      \"gender\": \"male\",\n      \"peopleCount\": 8,\n      \"label\": \"General count for datastructure\",\n      \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n      \"severity\": 4\n    }, {\n      \"timestamp\": \"2011-10-20\",\n      \"count\": 123,\n      \"event\": [{\n        'evetType': 'this is the first event'\n      }, {\n        'evetType': 'second event is printed here'\n      }],\n      \"gender\": \"male\",\n      \"peopleCount\": 8,\n      \"label\": \"General count for datastructure\",\n      \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n      \"severity\": 4\n    }, {\n      \"timestamp\": \"2012-10-20\",\n      \"count\": 96,\n      \"event\": [{\n        'evetType': 'this is the first event'\n      }, {\n        'evetType': 'second event is printed here'\n      }],\n      \"gender\": \"male\",\n      \"peopleCount\": 8,\n      \"label\": \"General count for datastructure\",\n      \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n      \"severity\": 2\n    }, {\n      \"timestamp\": \"2013-10-20\",\n      \"count\": 336,\n      \"event\": [{\n        'evetType': 'this is the first event'\n      }, {\n        'evetType': 'second event is printed here'\n      }],\n      \"gender\": \"male\",\n      \"peopleCount\": 8,\n      \"label\": \"General count for datastructure\",\n      \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n      \"severity\": 3\n    }, {\n      \"timestamp\": \"2014-10-20\",\n      \"count\": 169,\n      \"event\": [{\n        'evetType': 'this is the first event'\n      }, {\n        'evetType': 'second event is printed here'\n      }],\n      \"gender\": \"female\",\n      \"peopleCount\": 2,\n      \"label\": \"General count for datastructure\",\n      \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n      \"severity\": 1\n    }, {\n      \"timestamp\": \"2015-10-20\",\n      \"count\": 288,\n      \"event\": [{\n        'evetType': 'this is the first event'\n      }, {\n        'evetType': 'second event is printed here'\n      }],\n      \"gender\": \"female\",\n      \"peopleCount\": 2,\n      \"label\": \"General count for datastructure\",\n      \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n      \"severity\": 1\n    }, {\n      \"timestamp\": \"2016-10-20\",\n      \"count\": 169,\n      \"event\": [{\n        'evetType': 'this is the first event'\n      }, {\n        'evetType': 'second event is printed here'\n      }],\n      \"gender\": \"female\",\n      \"peopleCount\": 2,\n      \"label\": \"General count for datastructure\",\n      \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n      \"severity\": 1\n    }, {\n      \"timestamp\": \"2017-10-20\",\n      \"count\": 99,\n      \"event\": [{\n        'evetType': 'this is the first event'\n      }, {\n        'evetType': 'second event is printed here'\n      }],\n      \"gender\": \"female\",\n      \"peopleCount\": 2,\n      \"label\": \"General count for datastructure\",\n      \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n      \"severity\": 1\n    }, {\n      \"timestamp\": \"2018-10-20\",\n      \"count\": 15,\n      \"event\": [{\n        'evetType': 'this is the first event'\n      }, {\n        'evetType': 'second event is printed here'\n      }],\n      \"gender\": \"female\",\n      \"peopleCount\": 2,\n      \"label\": \"General count for datastructure\",\n      \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n      \"severity\": 1\n    }, {\n      \"timestamp\": \"2019-10-20\",\n      \"count\": 210,\n      \"event\": [{\n        'evetType': 'this is the first event'\n      }, {\n        'evetType': 'second event is printed here'\n      }],\n      \"gender\": \"female\",\n      \"peopleCount\": 2,\n      \"label\": \"General count for datastructure\",\n      \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n      \"severity\": 1\n    }];\n    data.forEach(function (d) {\n      d[xLable] = parseTime(d[xLable]);\n    });\n    var xMin = d3.min(data, function (d) {\n      return d[xLable];\n    });\n    var yMax = Math.max(20, d3.max(data, function (d) {\n      return d[count];\n    }));\n    x.domain([xMin, new Date()]);\n    y.domain([0, yMax]);\n    x2.domain(x.domain());\n    y2.domain(y.domain());\n\n    var num_messages = function (dataArray, domainRange) {\n      return d3.sum(dataArray, function (d) {\n        return d[xLable] >= domainRange.domain()[0] && d[xLable] <= domainRange.domain()[1];\n      });\n    }; // append scatter plot to main chart area\n\n\n    var messages = focus.selectAll('g').data(data).enter().append(\"g\");\n    messages.attr(\"clip-path\", \"url(#clip)\");\n    messages.append(\"circle\").attr('class', 'message').attr(\"r\", 7).attr(\"cx\", function (d) {\n      return x(d[xLable]);\n    }).attr(\"cy\", function (d) {\n      return y(d[count]);\n    });\n    messages.append('text').attr('class', 'node-text').text(function (d) {\n      return d[textVal];\n    }).attr(\"x\", function (d) {\n      return x(d[xLable]) + 10;\n    }).attr(\"y\", function (d) {\n      return y(d[count]);\n    }).style('font-size', '10px');\n    focus.append(\"g\").attr(\"class\", \"axis x-axis\").attr(\"transform\", \"translate(0,\" + height + \")\").call(xAxis2);\n    focus.append(\"g\").attr(\"class\", \"brush\").call(brush);\n    var j = svg.selectAll(\".circle-vertical-line\").data(data);\n    j.enter().append(\"line\").attr(\"class\", \"circle-vertical-line\").merge(j).attr('transform', 'translate(0, ' + margin.top + ')').attr(\"x1\", function (d) {\n      return x(d[xLable]);\n    }).attr(\"x2\", function (d) {\n      return x(d[xLable]);\n    }).attr(\"y1\", y(0)).attr(\"y2\", function (d) {\n      return y(d[count]);\n    }).attr(\"stroke\", \"#000000\"); //     .attr(\"width\", width)\n    //     .attr(\"height\", height)\n    //   svg.append(\"rect\")\n    //     .attr('fill-opacity', 0)\n    //     .attr(\"class\", \"zoom\")\n    //     .attr(\"width\", width)\n    //     .attr(\"height\", height)\n    //     .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n    //     .call(zoom);\n    // append scatter plot to brush chart area\n    //    var messages = context.append(\"g\");\n    //        messages.attr(\"clip-path\", \"url(#clip)\");\n    //        messages.selectAll(\"message\")\n    //           .data(data)\n    //           .enter().append(\"circle\")\n    //           .attr('class', 'messageContext')\n    //           .attr(\"r\",3)\n    //           .style(\"opacity\", .6)\n    //           .attr(\"cx\", function(d) { return x2(d[xLable]); })\n    //           .attr(\"cy\", function(d) { return y2(d[count]); })\n    //   context.append(\"g\")\n    //         .attr(\"class\", \"axis x-axis\")\n    //         .attr(\"transform\", \"translate(0,\" + height2 + \")\")\n    //         .call(xAxis2);\n    //create brush function redraw scatterplot with selection\n\n    function brushed() {\n      if (d3.event.sourceEvent && d3.event.sourceEvent.type === \"zoom\") return; // ignore brush-by-zoom\n\n      var s = d3.event.selection || x2.range();\n      x.domain(s.map(x2.invert, x2));\n      focus.selectAll('.node-text').attr(\"x\", function (d) {\n        return x(d[xLable]) + 10;\n      }).attr(\"y\", function (d) {\n        return y(d[count]);\n      });\n      focus.selectAll(\".message\").attr(\"cx\", function (d) {\n        return x(d[xLable]);\n      }).attr(\"cy\", function (d) {\n        return y(d[count]);\n      });\n      focus.select(\".x-axis\").call(xAxis);\n      svg.select(\".zoom\").call(zoom.transform, d3.zoomIdentity.scale(width / (s[1] - s[0])).translate(-s[0], 0));\n    }\n\n    function zoomed() {\n      if (d3.event.sourceEvent && d3.event.sourceEvent.type === \"brush\") return; // ignore zoom-by-brush\n\n      var t = d3.event.transform;\n      x.domain(t.rescaleX(x2).domain());\n      focus.selectAll(\".message\").attr(\"cx\", function (d) {\n        return x(d[xLable]);\n      }).attr(\"cy\", function (d) {\n        return y(d[count]);\n      });\n      focus.select(\".x-axis\").call(xAxis);\n      context.select(\".brush\").call(brush.move, x.range().map(t.invertX, t));\n    }\n  }\n\n  const d3Container = useRef(null);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d3-lollipop-chart\",\n    width: 996,\n    height: 444,\n    ref: d3Container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 9\n    }\n  });\n};\n\nexport default PerfectTimeline;","map":{"version":3,"sources":["/home/fazal/Documents/claudius/D3-charts/src/LollipopChart6.js"],"names":["React","useRef","useEffect","d3","lab","moment","require","PerfectTimeline","props","drawChart","margin","top","right","bottom","left","margin2","width","height","height2","parseTime","timeParse","x","scaleTime","range","x2","y","scaleLinear","y2","xAxis","axisBottom","tickSize","xAxis2","yAxis","axisLeft","brush","brushX","extent","on","brushed","zoom","scaleExtent","Infinity","translateExtent","zoomed","svg","select","d3Container","current","append","attr","focus","context","count","xLable","textVal","data","forEach","d","xMin","min","yMax","Math","max","domain","Date","num_messages","dataArray","domainRange","sum","messages","selectAll","enter","text","style","call","j","merge","event","sourceEvent","type","s","selection","map","invert","transform","zoomIdentity","scale","translate","t","rescaleX","move","invertX"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport * as d3 from 'd3';\nimport { lab } from 'd3';\nconst moment = require('moment');\n\n\nconst PerfectTimeline = (props) => {\n    useEffect(() => {\n        drawChart();\n    });\n\n    function drawChart() {\n\n        var margin = {top: 20, right: 20, bottom: 90, left: 50},\n        margin2 = {top: 230, right: 20, bottom: 30, left: 50},\n        width = 960 - margin.left - margin.right,\n        height = 300 - margin.top - margin.bottom,\n        height2 = 300 - margin2.top - margin2.bottom;\n    \n    var parseTime = d3.timeParse(\"%Y-%m-%d\");\n    \n    var x = d3.scaleTime().range([0, width]),\n        x2 = d3.scaleTime().range([0, width]),\n        y = d3.scaleLinear().range([height, 0]),\n        y2 = d3.scaleLinear().range([height2, 0]);\n    \n    var xAxis = d3.axisBottom(x).tickSize(0),\n        xAxis2 = d3.axisBottom(x2).tickSize(0),\n        yAxis = d3.axisLeft(y).tickSize(0);\n    \n    var brush = d3.brushX()\n        .extent([[0, 0], [width, height]])\n        .on(\"brush\", brushed);\n    \n    var zoom = d3.zoom()\n        .scaleExtent([1, Infinity])\n        .translateExtent([[0, 0], [width, height]])\n        .extent([[0, 0], [width, height]])\n        .on(\"zoom\", zoomed);\n    \n    var svg = d3.select(d3Container.current).append(\"svg\")\n        .attr(\"width\", width + margin.left + margin.right)\n        .attr(\"height\", height + margin.top + margin.bottom);\n    \n    svg.append(\"defs\").append(\"clipPath\")\n        .attr(\"id\", \"clip\")\n      .append(\"rect\")\n        .attr(\"width\", width)\n        .attr(\"height\", height);\n    \n    var focus = svg.append(\"g\")\n        .attr(\"class\", \"focus\")\n        .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    \n    var context = svg.append(\"g\")\n        .attr(\"class\", \"context\")\n        .attr(\"transform\", \"translate(\" + margin2.left + \",\" + margin2.top + \")\");\n\n\n        var count = 'count';\n        var xLable = 'timestamp';\n        var textVal = 'label';\n\n\n        \n        var data = [\n            {\n                \"timestamp\": \"2010-10-20\",\n                \"count\": 62,\n                \"event\": [{'evetType': 'this is the first event'},{'evetType': 'second event is printed here'}],\n                \"gender\": \"male\",\n                \"peopleCount\": 8,\n                \"label\": \"General count for datastructure\",\n                \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n                \"severity\": 4\n            },\n            {\n                \"timestamp\": \"2011-10-20\",\n                \"count\": 123,\n                \"event\": [{'evetType': 'this is the first event'},{'evetType': 'second event is printed here'}],\n                \"gender\": \"male\",\n                \"peopleCount\": 8,\n                \"label\": \"General count for datastructure\",\n                \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n                \"severity\": 4\n            },\n            {\n                \"timestamp\": \"2012-10-20\",\n                \"count\": 96,\n                \"event\": [{'evetType': 'this is the first event'},{'evetType': 'second event is printed here'}],\n                \"gender\": \"male\",\n                \"peopleCount\": 8,\n                \"label\": \"General count for datastructure\",\n                \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n                \"severity\": 2\n            },\n            {\n                \"timestamp\": \"2013-10-20\",\n                \"count\": 336,\n                \"event\": [{'evetType': 'this is the first event'},{'evetType': 'second event is printed here'}],\n                \"gender\": \"male\",\n                \"peopleCount\": 8,\n                \"label\": \"General count for datastructure\",\n                \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n                \"severity\": 3\n            },\n            {\n                \"timestamp\": \"2014-10-20\",\n                \"count\": 169,\n                \"event\": [{'evetType': 'this is the first event'},{'evetType': 'second event is printed here'}],\n                \"gender\": \"female\",\n                \"peopleCount\": 2,\n                \"label\": \"General count for datastructure\",\n                \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n                \"severity\": 1\n            },\n            {\n                \"timestamp\": \"2015-10-20\",\n                \"count\": 288,\n                \"event\": [{'evetType': 'this is the first event'},{'evetType': 'second event is printed here'}],\n                \"gender\": \"female\",\n                \"peopleCount\": 2,\n                \"label\": \"General count for datastructure\",\n                \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n                \"severity\": 1\n            },\n            {\n                \"timestamp\": \"2016-10-20\",\n                \"count\": 169,\n                \"event\": [{'evetType': 'this is the first event'},{'evetType': 'second event is printed here'}],\n                \"gender\": \"female\",\n                \"peopleCount\": 2,\n                \"label\": \"General count for datastructure\",\n                \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n                \"severity\": 1\n            },\n            {\n                \"timestamp\": \"2017-10-20\",\n                \"count\": 99,\n                \"event\": [{'evetType': 'this is the first event'},{'evetType': 'second event is printed here'}],\n                \"gender\": \"female\",\n                \"peopleCount\": 2,\n                \"label\": \"General count for datastructure\",\n                \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n                \"severity\": 1\n            },\n            {\n                \"timestamp\": \"2018-10-20\",\n                \"count\": 15,\n                \"event\": [{'evetType': 'this is the first event'},{'evetType': 'second event is printed here'}],\n                \"gender\": \"female\",\n                \"peopleCount\": 2,\n                \"label\": \"General count for datastructure\",\n                \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n                \"severity\": 1\n            },\n            {\n                \"timestamp\": \"2019-10-20\",\n                \"count\": 210,\n                \"event\": [{'evetType': 'this is the first event'},{'evetType': 'second event is printed here'}],\n                \"gender\": \"female\",\n                \"peopleCount\": 2,\n                \"label\": \"General count for datastructure\",\n                \"description\": \"Raphael painted school of Athens for POP THE JULIUS SECOND and he was contemprory of michelangelo\",\n                \"severity\": 1\n            },\n        ];\n\n        data.forEach(function(d) {\n            d[xLable] = parseTime(d[xLable]);\n          });\n        \n          var xMin = d3.min(data, function(d) { return d[xLable]; });\n          var yMax = Math.max(20, d3.max(data, function(d) { return d[count]; }));\n        \n          x.domain([xMin, new Date()]);\n          y.domain([0, yMax]);\n          x2.domain(x.domain());\n          y2.domain(y.domain());\n        \n          var num_messages = function(dataArray, domainRange) { return d3.sum(dataArray, function(d) {\n            return d[xLable] >= domainRange.domain()[0] && d[xLable] <= domainRange.domain()[1];\n            })\n          }\n        \n          // append scatter plot to main chart area\n          var messages = focus.selectAll('g').data(data).enter().append(\"g\");\n\n            messages.attr(\"clip-path\", \"url(#clip)\");\n\n\n            messages.append(\"circle\")\n                .attr('class', 'message')\n                .attr(\"r\", 7)\n                .attr(\"cx\", function(d) { return x(d[xLable]); })\n                .attr(\"cy\", function(d) { return y(d[count]); })\n        \n                messages.append('text')\n                .attr('class', 'node-text')\n                .text(function(d) {return d[textVal]})\n                .attr(\"x\", function (d) { return x(d[xLable])+10 })\n                .attr(\"y\", function (d) { return y(d[count]); })\n                .style('font-size', '10px')\n\n                \n                \n                focus.append(\"g\")\n                .attr(\"class\", \"axis x-axis\")\n                .attr(\"transform\", \"translate(0,\" + height + \")\")\n                .call(xAxis2);\n        \n\n          focus.append(\"g\")\n          .attr(\"class\", \"brush\")\n          .call(brush)\n\n\n\n\n          var j = svg.selectAll(\".circle-vertical-line\")\n          .data(data)\n        j\n          .enter()\n          .append(\"line\")\n          .attr(\"class\", \"circle-vertical-line\")\n          .merge(j)\n          .attr('transform', 'translate(0, '+margin.top+')')\n            .attr(\"x1\", function(d) { return x(d[xLable]); })\n            .attr(\"x2\", function(d) { return x(d[xLable]); })\n            .attr(\"y1\", y(0))\n            .attr(\"y2\", function(d) { return y(d[count]); })\n            .attr(\"stroke\", \"#000000\")\n  \n\n            \n\n        //     .attr(\"width\", width)\n        //     .attr(\"height\", height)\n                \n        //   svg.append(\"rect\")\n        //     .attr('fill-opacity', 0)\n        //     .attr(\"class\", \"zoom\")\n        //     .attr(\"width\", width)\n        //     .attr(\"height\", height)\n        //     .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n        //     .call(zoom);\n        \n          // append scatter plot to brush chart area\n        //    var messages = context.append(\"g\");\n        //        messages.attr(\"clip-path\", \"url(#clip)\");\n        //        messages.selectAll(\"message\")\n        //           .data(data)\n        //           .enter().append(\"circle\")\n        //           .attr('class', 'messageContext')\n        //           .attr(\"r\",3)\n        //           .style(\"opacity\", .6)\n        //           .attr(\"cx\", function(d) { return x2(d[xLable]); })\n        //           .attr(\"cy\", function(d) { return y2(d[count]); })\n        \n        //   context.append(\"g\")\n        //         .attr(\"class\", \"axis x-axis\")\n        //         .attr(\"transform\", \"translate(0,\" + height2 + \")\")\n        //         .call(xAxis2);\n        \n        \n          \n        \n        //create brush function redraw scatterplot with selection\n        function brushed() {\n          if (d3.event.sourceEvent && d3.event.sourceEvent.type === \"zoom\") return; // ignore brush-by-zoom\n          var s = d3.event.selection || x2.range();\n          x.domain(s.map(x2.invert, x2));\n\n\n          focus.selectAll('.node-text')\n          .attr(\"x\", function (d) { return x(d[xLable])+10 })\n          .attr(\"y\", function (d) { return y(d[count]); })\n\n\n          focus.selectAll(\".message\")\n                .attr(\"cx\", function(d) { return x(d[xLable]); })\n                .attr(\"cy\", function(d) { return y(d[count]); });\n          focus.select(\".x-axis\").call(xAxis);\n          svg.select(\".zoom\").call(zoom.transform, d3.zoomIdentity\n              .scale(width / (s[1] - s[0]))\n              .translate(-s[0], 0));\n        }\n        \n        function zoomed() {\n          if (d3.event.sourceEvent && d3.event.sourceEvent.type === \"brush\") return; // ignore zoom-by-brush\n          var t = d3.event.transform;\n          x.domain(t.rescaleX(x2).domain());\n\n\n\n          \n          focus.selectAll(\".message\")\n                .attr(\"cx\", function(d) { return x(d[xLable]); })\n                .attr(\"cy\", function(d) { return y(d[count]); });\n          focus.select(\".x-axis\").call(xAxis);\n          context.select(\".brush\").call(brush.move, x.range().map(t.invertX, t));\n        }\n\n    }\n\n    const d3Container = useRef(null);\n\n    return (\n        <div\n            className=\"d3-lollipop-chart\"\n            width={996}\n            height={444}\n            ref={d3Container}\n        ></div>\n    );\n}\n\nexport default PerfectTimeline;"]},"metadata":{},"sourceType":"module"}