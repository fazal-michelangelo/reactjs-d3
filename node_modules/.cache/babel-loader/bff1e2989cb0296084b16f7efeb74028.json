{"ast":null,"code":"var _jsxFileName = \"/home/fazal/Documents/claudius/D3-charts/src/BollingerBands2.js\";\n\n/* eslint-disable no-unused-expressions */\nimport React, { useRef, useEffect } from 'react';\nimport * as d3 from 'd3';\nimport { lab } from 'd3';\n\nconst moment = require('moment');\n\nconst BollingerBands = props => {\n  useEffect(() => {\n    drawChart();\n  });\n\n  function drawChart() {\n    var margin = {\n      top: 20,\n      right: 20,\n      bottom: 30,\n      left: 50\n    },\n        width = 960 - margin.left - margin.right,\n        height = 500 - margin.top - margin.bottom;\n    var n = 20; // n-period of moving average\n\n    var k = 2; // k times n-period standard deviation above/below moving average\n\n    var parseDate = d3.timeParse(\"%m/%d/%Y\");\n    var x = d3.scaleTime().range([0, width]);\n    var y = d3.scaleLinear().range([height, 0]); // var xAxis = d3.axisBottom(x).tickSize(0),\n    // xAxis2 = d3.axisBottom(x2).tickSize(0),\n    // yAxis = d3.axisLeft(y).tickSize(0);\n\n    var xAxis = d3.axisBottom(x); // var xAxis = d3.svg.axis()\n    //         .scale(x)\n    //         .orient(\"bottom\");\n    // var yAxis = d3.svg.axis()\n    //         .scale(y)\n    //         .orient(\"left\")\n    //         .tickSize(3, 0);\n\n    var yAxis = d3.axisLeft(y).tickSize(3);\n    var line = d3.svg.line().x(function (d) {\n      return x(d.date);\n    }).y(function (d) {\n      return y(d.close);\n    });\n    var ma = d3.svg.line().x(function (d) {\n      return x(d.date);\n    }).y(function (d) {\n      return y(d.ma);\n    });\n    var lowBand = d3.svg.line().x(function (d) {\n      return x(d.date);\n    }).y(function (d) {\n      return y(d.low);\n    });\n    var highBand = d3.svg.line().x(function (d) {\n      return x(d.date);\n    }).y(function (d) {\n      return y(d.high);\n    });\n    var bandsArea = d3.svg.area().x(function (d) {\n      return x(d.date);\n    }).y0(function (d) {\n      return y(d.low);\n    }).y1(function (d) {\n      return y(d.high);\n    });\n    var svg = d3.select(\"body\").append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    d3.csv(\"data.csv\", function (error, data) {\n      data.forEach(function (d) {\n        d.date = parseDate(d.date);\n        d.close = +d.close;\n      });\n      var bandsData = getBollingerBands(n, k, data);\n      x.domain(d3.extent(data, function (d) {\n        return d.date;\n      }));\n      y.domain([d3.min(bandsData, function (d) {\n        return d.low;\n      }), d3.max(bandsData, function (d) {\n        return d.high;\n      })]);\n      svg.append(\"g\").attr(\"class\", \"x axis\").attr(\"transform\", \"translate(0,\" + height + \")\").call(xAxis);\n      svg.append(\"g\").attr(\"class\", \"y axis\").call(yAxis);\n      svg.append(\"path\").datum(bandsData).attr(\"class\", \"area bands\").attr(\"d\", bandsArea);\n      svg.append(\"path\").datum(bandsData).attr(\"class\", \"line bands\").attr(\"d\", lowBand);\n      svg.append(\"path\").datum(bandsData).attr(\"class\", \"line bands\").attr(\"d\", highBand);\n      svg.append(\"path\").datum(bandsData).attr(\"class\", \"line ma bands\").attr(\"d\", ma);\n      svg.append(\"path\").datum(data).attr(\"class\", \"line\").attr(\"d\", line);\n    });\n\n    function getBollingerBands(n, k, data) {\n      var bands = []; //{ ma: 0, low: 0, high: 0 }\n\n      for (var i = n - 1, len = data.length; i < len; i++) {\n        var slice = data.slice(i + 1 - n, i);\n        var mean = d3.mean(slice, function (d) {\n          return d.close;\n        });\n        var stdDev = Math.sqrt(d3.mean(slice.map(function (d) {\n          return Math.pow(d.close - mean, 2);\n        })));\n        bands.push({\n          date: data[i].date,\n          ma: mean,\n          low: mean - k * stdDev,\n          high: mean + k * stdDev\n        });\n      }\n\n      return bands;\n    }\n  }\n\n  const d3Container = useRef(null);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d3-lollipop-chart\",\n    width: 996,\n    height: 444,\n    ref: d3Container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 9\n    }\n  });\n};\n\nexport default BollingerBands;","map":{"version":3,"sources":["/home/fazal/Documents/claudius/D3-charts/src/BollingerBands2.js"],"names":["React","useRef","useEffect","d3","lab","moment","require","BollingerBands","props","drawChart","margin","top","right","bottom","left","width","height","n","k","parseDate","timeParse","x","scaleTime","range","y","scaleLinear","xAxis","axisBottom","yAxis","axisLeft","tickSize","line","svg","d","date","close","ma","lowBand","low","highBand","high","bandsArea","area","y0","y1","select","append","attr","csv","error","data","forEach","bandsData","getBollingerBands","domain","extent","min","max","call","datum","bands","i","len","length","slice","mean","stdDev","Math","sqrt","map","pow","push","d3Container"],"mappings":"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","sourcesContent":["/* eslint-disable no-unused-expressions */\n\nimport React, { useRef, useEffect } from 'react';\nimport * as d3 from 'd3';\nimport { lab } from 'd3';\nconst moment = require('moment');\n\n\nconst BollingerBands = (props) => {\n    useEffect(() => {\n        drawChart();\n    });\n\n    function drawChart() {\n\n        var margin = { top: 20, right: 20, bottom: 30, left: 50 },\n        width = 960 - margin.left - margin.right,\n        height = 500 - margin.top - margin.bottom;\n  \n    var n = 20; // n-period of moving average\n    var k = 2;  // k times n-period standard deviation above/below moving average\n  \n    var parseDate = d3.timeParse(\"%m/%d/%Y\");\n\n    var x = d3.scaleTime()\n            .range([0, width]);\n\n\n    var y = d3.scaleLinear()\n            .range([height, 0]);\n\n\n            // var xAxis = d3.axisBottom(x).tickSize(0),\n            // xAxis2 = d3.axisBottom(x2).tickSize(0),\n            // yAxis = d3.axisLeft(y).tickSize(0);\n\n            \n    var xAxis = d3.axisBottom(x);\n\n    // var xAxis = d3.svg.axis()\n    //         .scale(x)\n    //         .orient(\"bottom\");\n\n    // var yAxis = d3.svg.axis()\n    //         .scale(y)\n    //         .orient(\"left\")\n    //         .tickSize(3, 0);\n\n    var yAxis = d3.axisLeft(y).tickSize(3);\n    var line = d3.svg.line()\n            .x(function(d) { return x(d.date); })\n            .y(function(d) { return y(d.close); });\n    var ma = d3.svg.line()\n            .x(function(d) { return x(d.date); })\n            .y(function(d) { return y(d.ma); });\n    var lowBand = d3.svg.line()\n            .x(function(d) { return x(d.date); })\n            .y(function(d) { return y(d.low); });\n    var highBand = d3.svg.line()\n            .x(function(d) { return x(d.date); })\n            .y(function(d) { return y(d.high); });\n    var bandsArea = d3.svg.area()\n            .x(function(d) { return x(d.date); })\n            .y0(function(d) { return y(d.low); })\n            .y1(function(d) { return y(d.high); });\n  \n    var svg = d3.select(\"body\").append(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n  \n    d3.csv(\"data.csv\", function(error, data) {\n        data.forEach(function(d) {\n            d.date = parseDate(d.date);\n            d.close = +d.close;\n        });\n  \n        var bandsData = getBollingerBands(n, k, data);\n  \n        x.domain(d3.extent(data, function(d) { return d.date; }));\n        y.domain([ d3.min(bandsData, function(d) { return d.low; }),\n                   d3.max(bandsData, function(d) { return d.high; }) ]);\n  \n        svg.append(\"g\")\n                .attr(\"class\", \"x axis\")\n                .attr(\"transform\", \"translate(0,\" + height + \")\")\n                .call(xAxis);\n        svg.append(\"g\")\n                .attr(\"class\", \"y axis\")\n                .call(yAxis);\n  \n        svg.append(\"path\")\n                .datum(bandsData)\n                .attr(\"class\", \"area bands\")\n                .attr(\"d\", bandsArea);\n        svg.append(\"path\")\n                .datum(bandsData)\n                .attr(\"class\", \"line bands\")\n                .attr(\"d\", lowBand);\n        svg.append(\"path\")\n                .datum(bandsData)\n                .attr(\"class\", \"line bands\")\n                .attr(\"d\", highBand);\n        svg.append(\"path\")\n                .datum(bandsData)\n                .attr(\"class\", \"line ma bands\")\n                .attr(\"d\", ma);\n  \n        svg.append(\"path\")\n                .datum(data)\n                .attr(\"class\", \"line\")\n                .attr(\"d\", line);\n    });\n  \n      function getBollingerBands(n, k, data) {\n          var bands = []; //{ ma: 0, low: 0, high: 0 }\n          for (var i = n - 1, len = data.length; i < len; i++) {\n              var slice = data.slice(i + 1 - n , i);\n              var mean = d3.mean(slice, function(d) { return d.close; });\n              var stdDev = Math.sqrt(d3.mean(slice.map(function(d) {\n                  return Math.pow(d.close - mean, 2);\n              })));\n              bands.push({ date: data[i].date,\n                           ma: mean,\n                           low: mean - (k * stdDev),\n                           high: mean + (k * stdDev) });\n          }\n          return bands;\n      }\n\n    }\n\n    const d3Container = useRef(null);\n\n    return (\n        <div\n            className=\"d3-lollipop-chart\"\n            width={996}\n            height={444}\n            ref={d3Container}\n        ></div>\n    );\n}\n\nexport default BollingerBands;"]},"metadata":{},"sourceType":"module"}