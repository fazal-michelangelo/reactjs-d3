{"ast":null,"code":"import React,{useRef,useEffect}from'react';import*as d3 from'd3';/* Component */var MyD3Component=function MyD3Component(props){useEffect(function(){drawChart();});function drawChart(){var jsondata={\"nodes\":[],\"links\":[]};var pivotData={\"AtkScore\":[\"385\",\"135\",\"110\"],\"ChainPhase\":[\"Lateral Movement\",\"Data Theft\",\"Privilege Escalation\"],\"ThreatIds\":[\"credtheft_kerberoasting\\n\",\"filetheft_active_monitoring\\n\"]};function initNodeStructure(){var index=0;jsondata.nodes.push({'id':'realm','group':index});jsondata.nodes.push({'id':'USER','group':index});jsondata.links.push({'source':'USER','target':'realm','value':0});for(var key in pivotData){if(pivotData.hasOwnProperty(key)){jsondata.links.push({'source':key,'target':'realm','value':0});index++;jsondata.nodes.push({'id':key,'group':index});for(var i=0;i<pivotData[key].length;i++){jsondata.nodes.push({'id':pivotData[key][i],'group':index});jsondata.links.push({'source':pivotData[key][i],'target':key,'value':index});}}}console.log(jsondata);}initNodeStructure();var width=800;var height=600;var color=d3.scaleOrdinal(d3.schemeCategory10);var label={'nodes':[],'links':[]};jsondata.nodes.forEach(function(d,i){label.nodes.push({node:d});label.nodes.push({node:d});label.links.push({source:i*2,target:i*2+1});});var labelLayout=d3.forceSimulation(label.nodes).force(\"charge\",d3.forceManyBody().strength(-50)).force(\"link\",d3.forceLink(label.links).distance(0).strength(2));var graphLayout=d3.forceSimulation(jsondata.nodes).force(\"charge\",d3.forceManyBody().strength(-3000)).force(\"center\",d3.forceCenter(width/2,height/2)).force(\"x\",d3.forceX(width/2).strength(1)).force(\"y\",d3.forceY(height/2).strength(1)).force(\"link\",d3.forceLink(jsondata.links).id(function(d){return d.id;}).distance(50).strength(1)).on(\"tick\",ticked);var adjlist=[];jsondata.links.forEach(function(d){adjlist[d.source.index+\"-\"+d.target.index]=true;adjlist[d.target.index+\"-\"+d.source.index]=true;});function neigh(a,b){return a==b||adjlist[a+\"-\"+b];}var svg=d3.select(d3Container.current).attr(\"width\",width).attr(\"height\",height);var container=svg.append(\"g\");svg.call(d3.zoom().scaleExtent([.1,4]).on(\"zoom\",function(){container.attr(\"transform\",d3.event.transform);}));var link=container.append(\"g\").attr(\"class\",\"links\").selectAll(\"line\").data(jsondata.links).enter().append(\"line\").attr(\"stroke\",\"#aaa\").attr(\"stroke-width\",\"1px\");var node=container.append(\"g\").attr(\"class\",\"nodes\").selectAll(\"g\").data(jsondata.nodes).enter().append(\"circle\").attr(\"r\",5).attr(\"fill\",function(d){return color(d.group);});// .append('text')\n// .attr('font-family', 'Arial')\n// .attr('font-size', '14px')\n// .text(function (d) { return d.fontIcon });\nnode.on(\"mouseover\",focus).on(\"mouseout\",unfocus);node.call(d3.drag().on(\"start\",dragstarted).on(\"drag\",dragged).on(\"end\",dragended));var labelNode=container.append(\"g\").attr(\"class\",\"labelNodes\").selectAll(\"text\").data(label.nodes).enter().append(\"text\").text(function(d,i){return i%2==0?\"\":d.node.id;}).style(\"fill\",\"#555\").style(\"font-family\",\"Arial\").style(\"font-size\",12).style(\"pointer-events\",\"none\");// to prevent mouseover/drag capture\nnode.on(\"mouseover\",focus).on(\"mouseout\",unfocus);function ticked(){node.call(updateNode);link.call(updateLink);labelLayout.alphaTarget(0.3).restart();labelNode.each(function(d,i){if(i%2==0){d.x=d.node.x;d.y=d.node.y;}else{var b=this.getBBox();var diffX=d.x-d.node.x;var diffY=d.y-d.node.y;var dist=Math.sqrt(diffX*diffX+diffY*diffY);var shiftX=b.width*(diffX-dist)/(dist*2);shiftX=Math.max(-b.width,Math.min(0,shiftX));var shiftY=16;this.setAttribute(\"transform\",\"translate(\"+shiftX+\",\"+shiftY+\")\");}});labelNode.call(updateNode);}function fixna(x){if(isFinite(x))return x;return 0;}function focus(d){var index=d3.select(d3.event.target).datum().index;node.style(\"opacity\",function(o){return neigh(index,o.index)?1:0.1;});labelNode.attr(\"display\",function(o){return neigh(index,o.node.index)?\"block\":\"none\";});link.style(\"opacity\",function(o){return o.source.index==index||o.target.index==index?1:0.1;});}function unfocus(){labelNode.attr(\"display\",\"block\");node.style(\"opacity\",1);link.style(\"opacity\",1);}function updateLink(link){link.attr(\"x1\",function(d){return fixna(d.source.x);}).attr(\"y1\",function(d){return fixna(d.source.y);}).attr(\"x2\",function(d){return fixna(d.target.x);}).attr(\"y2\",function(d){return fixna(d.target.y);});}function updateNode(node){node.attr(\"transform\",function(d){return\"translate(\"+fixna(d.x)+\",\"+fixna(d.y)+\")\";});}function dragstarted(d){d3.event.sourceEvent.stopPropagation();if(!d3.event.active)graphLayout.alphaTarget(0.3).restart();d.fx=d.x;d.fy=d.y;}function dragged(d){d.fx=d3.event.x;d.fy=d3.event.y;}function dragended(d){if(!d3.event.active)graphLayout.alphaTarget(0);d.fx=null;d.fy=null;}}/* The useRef Hook creates a variable that \"holds on\" to a value across rendering\n       passes. In this case it will hold our component's SVG DOM element. It's\n       initialized null and React will assign it later (see the return statement) */var d3Container=useRef(null);/* The useEffect Hook is for running side effects outside of React,\n       for instance inserting elements into the DOM using D3 */return/*#__PURE__*/React.createElement(\"svg\",{className:\"d3-component\",width:400,height:200,ref:d3Container});};export default MyD3Component;","map":{"version":3,"sources":["/home/fazal/Documents/claudius/D3-charts/src/DDDHooksChart.js"],"names":["React","useRef","useEffect","d3","MyD3Component","props","drawChart","jsondata","pivotData","initNodeStructure","index","nodes","push","links","key","hasOwnProperty","i","length","console","log","width","height","color","scaleOrdinal","schemeCategory10","label","forEach","d","node","source","target","labelLayout","forceSimulation","force","forceManyBody","strength","forceLink","distance","graphLayout","forceCenter","forceX","forceY","id","on","ticked","adjlist","neigh","a","b","svg","select","d3Container","current","attr","container","append","call","zoom","scaleExtent","event","transform","link","selectAll","data","enter","group","focus","unfocus","drag","dragstarted","dragged","dragended","labelNode","text","style","updateNode","updateLink","alphaTarget","restart","each","x","y","getBBox","diffX","diffY","dist","Math","sqrt","shiftX","max","min","shiftY","setAttribute","fixna","isFinite","datum","o","sourceEvent","stopPropagation","active","fx","fy"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,EAAgBC,MAAhB,CAAwBC,SAAxB,KAAyC,OAAzC,CACA,MAAO,GAAKC,CAAAA,EAAZ,KAAoB,IAApB,CAEA,eACA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,KAAD,CAAW,CAK7BH,SAAS,CAAC,UAAM,CACZI,SAAS,GACZ,CAFQ,CAAT,CAIA,QAASA,CAAAA,SAAT,EAAqB,CAGjB,GAAMC,CAAAA,QAAQ,CAAG,CACb,QAAS,EADI,CAGb,QAAS,EAHI,CAAjB,CASA,GAAMC,CAAAA,SAAS,CAAG,CACd,WAAY,CACR,KADQ,CAER,KAFQ,CAGR,KAHQ,CADE,CAMd,aAAc,CACV,kBADU,CAEV,YAFU,CAGV,sBAHU,CANA,CAWd,YAAa,CACT,2BADS,CAET,+BAFS,CAXC,CAAlB,CAiBA,QAASC,CAAAA,iBAAT,EAA6B,CACzB,GAAIC,CAAAA,KAAK,CAAG,CAAZ,CACAH,QAAQ,CAACI,KAAT,CAAeC,IAAf,CAAoB,CAAC,KAAM,OAAP,CAAgB,QAASF,KAAzB,CAApB,EACAH,QAAQ,CAACI,KAAT,CAAeC,IAAf,CAAoB,CAAC,KAAM,MAAP,CAAe,QAASF,KAAxB,CAApB,EACAH,QAAQ,CAACM,KAAT,CAAeD,IAAf,CAAoB,CAAC,SAAU,MAAX,CAAmB,SAAU,OAA7B,CAAsC,QAAS,CAA/C,CAApB,EAEA,IAAK,GAAIE,CAAAA,GAAT,GAAgBN,CAAAA,SAAhB,CAA2B,CACvB,GAAIA,SAAS,CAACO,cAAV,CAAyBD,GAAzB,CAAJ,CAAmC,CAC/BP,QAAQ,CAACM,KAAT,CAAeD,IAAf,CAAoB,CAAC,SAAUE,GAAX,CAAgB,SAAU,OAA1B,CAAmC,QAAS,CAA5C,CAApB,EACAJ,KAAK,GACLH,QAAQ,CAACI,KAAT,CAAeC,IAAf,CAAoB,CAAC,KAAME,GAAP,CAAY,QAASJ,KAArB,CAApB,EACA,IAAI,GAAIM,CAAAA,CAAC,CAAG,CAAZ,CAAgBA,CAAC,CAAGR,SAAS,CAACM,GAAD,CAAT,CAAeG,MAAnC,CAA2CD,CAAC,EAA5C,CAAgD,CAC5CT,QAAQ,CAACI,KAAT,CAAeC,IAAf,CAAoB,CAAC,KAAMJ,SAAS,CAACM,GAAD,CAAT,CAAeE,CAAf,CAAP,CAA0B,QAASN,KAAnC,CAApB,EACAH,QAAQ,CAACM,KAAT,CAAeD,IAAf,CAAoB,CAAC,SAAUJ,SAAS,CAACM,GAAD,CAAT,CAAeE,CAAf,CAAX,CAA8B,SAAUF,GAAxC,CAA6C,QAASJ,KAAtD,CAApB,EACH,CACJ,CACJ,CACDQ,OAAO,CAACC,GAAR,CAAYZ,QAAZ,EACH,CAEDE,iBAAiB,GAGjB,GAAIW,CAAAA,KAAK,CAAG,GAAZ,CACA,GAAIC,CAAAA,MAAM,CAAG,GAAb,CACA,GAAIC,CAAAA,KAAK,CAAGnB,EAAE,CAACoB,YAAH,CAAgBpB,EAAE,CAACqB,gBAAnB,CAAZ,CAEA,GAAIC,CAAAA,KAAK,CAAG,CACR,QAAS,EADD,CAER,QAAS,EAFD,CAAZ,CAKAlB,QAAQ,CAACI,KAAT,CAAee,OAAf,CAAuB,SAAUC,CAAV,CAAaX,CAAb,CAAgB,CACnCS,KAAK,CAACd,KAAN,CAAYC,IAAZ,CAAiB,CAAEgB,IAAI,CAAED,CAAR,CAAjB,EACAF,KAAK,CAACd,KAAN,CAAYC,IAAZ,CAAiB,CAAEgB,IAAI,CAAED,CAAR,CAAjB,EACAF,KAAK,CAACZ,KAAN,CAAYD,IAAZ,CAAiB,CACbiB,MAAM,CAAEb,CAAC,CAAG,CADC,CAEbc,MAAM,CAAEd,CAAC,CAAG,CAAJ,CAAQ,CAFH,CAAjB,EAIH,CAPD,EASA,GAAIe,CAAAA,WAAW,CAAG5B,EAAE,CAAC6B,eAAH,CAAmBP,KAAK,CAACd,KAAzB,EACbsB,KADa,CACP,QADO,CACG9B,EAAE,CAAC+B,aAAH,GAAmBC,QAAnB,CAA4B,CAAC,EAA7B,CADH,EAEbF,KAFa,CAEP,MAFO,CAEC9B,EAAE,CAACiC,SAAH,CAAaX,KAAK,CAACZ,KAAnB,EAA0BwB,QAA1B,CAAmC,CAAnC,EAAsCF,QAAtC,CAA+C,CAA/C,CAFD,CAAlB,CAIA,GAAIG,CAAAA,WAAW,CAAGnC,EAAE,CAAC6B,eAAH,CAAmBzB,QAAQ,CAACI,KAA5B,EACbsB,KADa,CACP,QADO,CACG9B,EAAE,CAAC+B,aAAH,GAAmBC,QAAnB,CAA4B,CAAC,IAA7B,CADH,EAEbF,KAFa,CAEP,QAFO,CAEG9B,EAAE,CAACoC,WAAH,CAAenB,KAAK,CAAG,CAAvB,CAA0BC,MAAM,CAAG,CAAnC,CAFH,EAGbY,KAHa,CAGP,GAHO,CAGF9B,EAAE,CAACqC,MAAH,CAAUpB,KAAK,CAAG,CAAlB,EAAqBe,QAArB,CAA8B,CAA9B,CAHE,EAIbF,KAJa,CAIP,GAJO,CAIF9B,EAAE,CAACsC,MAAH,CAAUpB,MAAM,CAAG,CAAnB,EAAsBc,QAAtB,CAA+B,CAA/B,CAJE,EAKbF,KALa,CAKP,MALO,CAKC9B,EAAE,CAACiC,SAAH,CAAa7B,QAAQ,CAACM,KAAtB,EAA6B6B,EAA7B,CAAgC,SAAUf,CAAV,CAAa,CAAE,MAAOA,CAAAA,CAAC,CAACe,EAAT,CAAc,CAA7D,EAA+DL,QAA/D,CAAwE,EAAxE,EAA4EF,QAA5E,CAAqF,CAArF,CALD,EAMbQ,EANa,CAMV,MANU,CAMFC,MANE,CAAlB,CAQA,GAAIC,CAAAA,OAAO,CAAG,EAAd,CAEAtC,QAAQ,CAACM,KAAT,CAAea,OAAf,CAAuB,SAAUC,CAAV,CAAa,CAChCkB,OAAO,CAAClB,CAAC,CAACE,MAAF,CAASnB,KAAT,CAAiB,GAAjB,CAAuBiB,CAAC,CAACG,MAAF,CAASpB,KAAjC,CAAP,CAAiD,IAAjD,CACAmC,OAAO,CAAClB,CAAC,CAACG,MAAF,CAASpB,KAAT,CAAiB,GAAjB,CAAuBiB,CAAC,CAACE,MAAF,CAASnB,KAAjC,CAAP,CAAiD,IAAjD,CACH,CAHD,EAKA,QAASoC,CAAAA,KAAT,CAAeC,CAAf,CAAkBC,CAAlB,CAAqB,CACjB,MAAOD,CAAAA,CAAC,EAAIC,CAAL,EAAUH,OAAO,CAACE,CAAC,CAAG,GAAJ,CAAUC,CAAX,CAAxB,CACH,CAED,GAAIC,CAAAA,GAAG,CAAG9C,EAAE,CAAC+C,MAAH,CAAUC,WAAW,CAACC,OAAtB,EAA+BC,IAA/B,CAAoC,OAApC,CAA6CjC,KAA7C,EAAoDiC,IAApD,CAAyD,QAAzD,CAAmEhC,MAAnE,CAAV,CACA,GAAIiC,CAAAA,SAAS,CAAGL,GAAG,CAACM,MAAJ,CAAW,GAAX,CAAhB,CAEAN,GAAG,CAACO,IAAJ,CACIrD,EAAE,CAACsD,IAAH,GACKC,WADL,CACiB,CAAC,EAAD,CAAK,CAAL,CADjB,EAEKf,EAFL,CAEQ,MAFR,CAEgB,UAAY,CAAEW,SAAS,CAACD,IAAV,CAAe,WAAf,CAA4BlD,EAAE,CAACwD,KAAH,CAASC,SAArC,EAAkD,CAFhF,CADJ,EAMA,GAAIC,CAAAA,IAAI,CAAGP,SAAS,CAACC,MAAV,CAAiB,GAAjB,EAAsBF,IAAtB,CAA2B,OAA3B,CAAoC,OAApC,EACNS,SADM,CACI,MADJ,EAENC,IAFM,CAEDxD,QAAQ,CAACM,KAFR,EAGNmD,KAHM,GAINT,MAJM,CAIC,MAJD,EAKNF,IALM,CAKD,QALC,CAKS,MALT,EAMNA,IANM,CAMD,cANC,CAMe,KANf,CAAX,CAQA,GAAIzB,CAAAA,IAAI,CAAG0B,SAAS,CAACC,MAAV,CAAiB,GAAjB,EAAsBF,IAAtB,CAA2B,OAA3B,CAAoC,OAApC,EACNS,SADM,CACI,GADJ,EAENC,IAFM,CAEDxD,QAAQ,CAACI,KAFR,EAGNqD,KAHM,GAINT,MAJM,CAIC,QAJD,EAKNF,IALM,CAKD,GALC,CAKI,CALJ,EAMNA,IANM,CAMD,MANC,CAMO,SAAU1B,CAAV,CAAa,CAAE,MAAOL,CAAAA,KAAK,CAACK,CAAC,CAACsC,KAAH,CAAZ,CAAwB,CAN9C,CAAX,CAOI;AACA;AACA;AACA;AAGJrC,IAAI,CAACe,EAAL,CAAQ,WAAR,CAAqBuB,KAArB,EAA4BvB,EAA5B,CAA+B,UAA/B,CAA2CwB,OAA3C,EAEAvC,IAAI,CAAC4B,IAAL,CACIrD,EAAE,CAACiE,IAAH,GACKzB,EADL,CACQ,OADR,CACiB0B,WADjB,EAEK1B,EAFL,CAEQ,MAFR,CAEgB2B,OAFhB,EAGK3B,EAHL,CAGQ,KAHR,CAGe4B,SAHf,CADJ,EAOA,GAAIC,CAAAA,SAAS,CAAGlB,SAAS,CAACC,MAAV,CAAiB,GAAjB,EAAsBF,IAAtB,CAA2B,OAA3B,CAAoC,YAApC,EACXS,SADW,CACD,MADC,EAEXC,IAFW,CAENtC,KAAK,CAACd,KAFA,EAGXqD,KAHW,GAIXT,MAJW,CAIJ,MAJI,EAKXkB,IALW,CAKN,SAAU9C,CAAV,CAAaX,CAAb,CAAgB,CAAE,MAAOA,CAAAA,CAAC,CAAG,CAAJ,EAAS,CAAT,CAAa,EAAb,CAAkBW,CAAC,CAACC,IAAF,CAAOc,EAAhC,CAAqC,CALjD,EAMXgC,KANW,CAML,MANK,CAMG,MANH,EAOXA,KAPW,CAOL,aAPK,CAOU,OAPV,EAQXA,KARW,CAQL,WARK,CAQQ,EARR,EASXA,KATW,CASL,gBATK,CASa,MATb,CAAhB,CASsC;AAEtC9C,IAAI,CAACe,EAAL,CAAQ,WAAR,CAAqBuB,KAArB,EAA4BvB,EAA5B,CAA+B,UAA/B,CAA2CwB,OAA3C,EAEA,QAASvB,CAAAA,MAAT,EAAkB,CAEdhB,IAAI,CAAC4B,IAAL,CAAUmB,UAAV,EACAd,IAAI,CAACL,IAAL,CAAUoB,UAAV,EAEA7C,WAAW,CAAC8C,WAAZ,CAAwB,GAAxB,EAA6BC,OAA7B,GACAN,SAAS,CAACO,IAAV,CAAe,SAAUpD,CAAV,CAAaX,CAAb,CAAgB,CAC3B,GAAIA,CAAC,CAAG,CAAJ,EAAS,CAAb,CAAgB,CACZW,CAAC,CAACqD,CAAF,CAAMrD,CAAC,CAACC,IAAF,CAAOoD,CAAb,CACArD,CAAC,CAACsD,CAAF,CAAMtD,CAAC,CAACC,IAAF,CAAOqD,CAAb,CACH,CAHD,IAGO,CACH,GAAIjC,CAAAA,CAAC,CAAG,KAAKkC,OAAL,EAAR,CAEA,GAAIC,CAAAA,KAAK,CAAGxD,CAAC,CAACqD,CAAF,CAAMrD,CAAC,CAACC,IAAF,CAAOoD,CAAzB,CACA,GAAII,CAAAA,KAAK,CAAGzD,CAAC,CAACsD,CAAF,CAAMtD,CAAC,CAACC,IAAF,CAAOqD,CAAzB,CAEA,GAAII,CAAAA,IAAI,CAAGC,IAAI,CAACC,IAAL,CAAUJ,KAAK,CAAGA,KAAR,CAAgBC,KAAK,CAAGA,KAAlC,CAAX,CAEA,GAAII,CAAAA,MAAM,CAAGxC,CAAC,CAAC5B,KAAF,EAAW+D,KAAK,CAAGE,IAAnB,GAA4BA,IAAI,CAAG,CAAnC,CAAb,CACAG,MAAM,CAAGF,IAAI,CAACG,GAAL,CAAS,CAACzC,CAAC,CAAC5B,KAAZ,CAAmBkE,IAAI,CAACI,GAAL,CAAS,CAAT,CAAYF,MAAZ,CAAnB,CAAT,CACA,GAAIG,CAAAA,MAAM,CAAG,EAAb,CACA,KAAKC,YAAL,CAAkB,WAAlB,CAA+B,aAAeJ,MAAf,CAAwB,GAAxB,CAA8BG,MAA9B,CAAuC,GAAtE,EACH,CACJ,CAjBD,EAkBAnB,SAAS,CAAChB,IAAV,CAAemB,UAAf,EAEH,CAED,QAASkB,CAAAA,KAAT,CAAeb,CAAf,CAAkB,CACd,GAAIc,QAAQ,CAACd,CAAD,CAAZ,CAAiB,MAAOA,CAAAA,CAAP,CACjB,MAAO,EAAP,CACH,CAED,QAASd,CAAAA,KAAT,CAAevC,CAAf,CAAkB,CACd,GAAIjB,CAAAA,KAAK,CAAGP,EAAE,CAAC+C,MAAH,CAAU/C,EAAE,CAACwD,KAAH,CAAS7B,MAAnB,EAA2BiE,KAA3B,GAAmCrF,KAA/C,CACAkB,IAAI,CAAC8C,KAAL,CAAW,SAAX,CAAsB,SAAUsB,CAAV,CAAa,CAC/B,MAAOlD,CAAAA,KAAK,CAACpC,KAAD,CAAQsF,CAAC,CAACtF,KAAV,CAAL,CAAwB,CAAxB,CAA4B,GAAnC,CACH,CAFD,EAGA8D,SAAS,CAACnB,IAAV,CAAe,SAAf,CAA0B,SAAU2C,CAAV,CAAa,CACnC,MAAOlD,CAAAA,KAAK,CAACpC,KAAD,CAAQsF,CAAC,CAACpE,IAAF,CAAOlB,KAAf,CAAL,CAA6B,OAA7B,CAAuC,MAA9C,CACH,CAFD,EAGAmD,IAAI,CAACa,KAAL,CAAW,SAAX,CAAsB,SAAUsB,CAAV,CAAa,CAC/B,MAAOA,CAAAA,CAAC,CAACnE,MAAF,CAASnB,KAAT,EAAkBA,KAAlB,EAA2BsF,CAAC,CAAClE,MAAF,CAASpB,KAAT,EAAkBA,KAA7C,CAAqD,CAArD,CAAyD,GAAhE,CACH,CAFD,EAGH,CAED,QAASyD,CAAAA,OAAT,EAAmB,CACfK,SAAS,CAACnB,IAAV,CAAe,SAAf,CAA0B,OAA1B,EACAzB,IAAI,CAAC8C,KAAL,CAAW,SAAX,CAAsB,CAAtB,EACAb,IAAI,CAACa,KAAL,CAAW,SAAX,CAAsB,CAAtB,EACH,CAED,QAASE,CAAAA,UAAT,CAAoBf,IAApB,CAA0B,CACtBA,IAAI,CAACR,IAAL,CAAU,IAAV,CAAgB,SAAU1B,CAAV,CAAa,CAAE,MAAOkE,CAAAA,KAAK,CAAClE,CAAC,CAACE,MAAF,CAASmD,CAAV,CAAZ,CAA2B,CAA1D,EACK3B,IADL,CACU,IADV,CACgB,SAAU1B,CAAV,CAAa,CAAE,MAAOkE,CAAAA,KAAK,CAAClE,CAAC,CAACE,MAAF,CAASoD,CAAV,CAAZ,CAA2B,CAD1D,EAEK5B,IAFL,CAEU,IAFV,CAEgB,SAAU1B,CAAV,CAAa,CAAE,MAAOkE,CAAAA,KAAK,CAAClE,CAAC,CAACG,MAAF,CAASkD,CAAV,CAAZ,CAA2B,CAF1D,EAGK3B,IAHL,CAGU,IAHV,CAGgB,SAAU1B,CAAV,CAAa,CAAE,MAAOkE,CAAAA,KAAK,CAAClE,CAAC,CAACG,MAAF,CAASmD,CAAV,CAAZ,CAA2B,CAH1D,EAIH,CAED,QAASN,CAAAA,UAAT,CAAoB/C,IAApB,CAA0B,CACtBA,IAAI,CAACyB,IAAL,CAAU,WAAV,CAAuB,SAAU1B,CAAV,CAAa,CAChC,MAAO,aAAekE,KAAK,CAAClE,CAAC,CAACqD,CAAH,CAApB,CAA4B,GAA5B,CAAkCa,KAAK,CAAClE,CAAC,CAACsD,CAAH,CAAvC,CAA+C,GAAtD,CACH,CAFD,EAGH,CAED,QAASZ,CAAAA,WAAT,CAAqB1C,CAArB,CAAwB,CACpBxB,EAAE,CAACwD,KAAH,CAASsC,WAAT,CAAqBC,eAArB,GACA,GAAI,CAAC/F,EAAE,CAACwD,KAAH,CAASwC,MAAd,CAAsB7D,WAAW,CAACuC,WAAZ,CAAwB,GAAxB,EAA6BC,OAA7B,GACtBnD,CAAC,CAACyE,EAAF,CAAOzE,CAAC,CAACqD,CAAT,CACArD,CAAC,CAAC0E,EAAF,CAAO1E,CAAC,CAACsD,CAAT,CACH,CAED,QAASX,CAAAA,OAAT,CAAiB3C,CAAjB,CAAoB,CAChBA,CAAC,CAACyE,EAAF,CAAOjG,EAAE,CAACwD,KAAH,CAASqB,CAAhB,CACArD,CAAC,CAAC0E,EAAF,CAAOlG,EAAE,CAACwD,KAAH,CAASsB,CAAhB,CACH,CAED,QAASV,CAAAA,SAAT,CAAmB5C,CAAnB,CAAsB,CAClB,GAAI,CAACxB,EAAE,CAACwD,KAAH,CAASwC,MAAd,CAAsB7D,WAAW,CAACuC,WAAZ,CAAwB,CAAxB,EACtBlD,CAAC,CAACyE,EAAF,CAAO,IAAP,CACAzE,CAAC,CAAC0E,EAAF,CAAO,IAAP,CACH,CACJ,CAID;;oFAGA,GAAMlD,CAAAA,WAAW,CAAGlD,MAAM,CAAC,IAAD,CAA1B,CAEA;+DAIA,mBACI,2BACI,SAAS,CAAC,cADd,CAEI,KAAK,CAAE,GAFX,CAGI,MAAM,CAAE,GAHZ,CAII,GAAG,CAAEkD,WAJT,EADJ,CAQH,CAjQD,CAmQA,cAAe/C,CAAAA,aAAf","sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport * as d3 from 'd3';\n\n/* Component */\nconst MyD3Component = (props) => {\n\n\n\n\n    useEffect(() => {\n        drawChart();\n    });\n\n    function drawChart() {\n\n\n        const jsondata = {\n            \"nodes\": [\n            ],\n            \"links\": [\n                \n            ]\n          }\n          ;\n    \n        const pivotData = {\n            \"AtkScore\": [\n                \"385\",\n                \"135\",\n                \"110\"\n            ],\n            \"ChainPhase\": [\n                \"Lateral Movement\",\n                \"Data Theft\",\n                \"Privilege Escalation\"\n            ],\n            \"ThreatIds\": [\n                \"credtheft_kerberoasting\\n\",\n                \"filetheft_active_monitoring\\n\"\n            ]\n        }\n        \n        function initNodeStructure() {\n            var index = 0;\n            jsondata.nodes.push({'id': 'realm', 'group': index});\n            jsondata.nodes.push({'id': 'USER', 'group': index});\n            jsondata.links.push({'source': 'USER', 'target': 'realm', 'value': 0})\n    \n            for (var key in pivotData) {  \n                if (pivotData.hasOwnProperty(key)) {\n                    jsondata.links.push({'source': key, 'target': 'realm', 'value': 0})\n                    index++;            \n                    jsondata.nodes.push({'id': key, 'group': index})\n                    for(var i = 0 ; i < pivotData[key].length; i++) {\n                        jsondata.nodes.push({'id': pivotData[key][i], 'group': index});\n                        jsondata.links.push({'source': pivotData[key][i], 'target': key, 'value': index})\n                    }\n                }\n            }\n            console.log(jsondata);\n        }\n\n        initNodeStructure()\n\n\n        var width = 800;\n        var height = 600;\n        var color = d3.scaleOrdinal(d3.schemeCategory10);\n\n        var label = {\n            'nodes': [],\n            'links': []\n        };\n\n        jsondata.nodes.forEach(function (d, i) {\n            label.nodes.push({ node: d });\n            label.nodes.push({ node: d });\n            label.links.push({\n                source: i * 2,\n                target: i * 2 + 1\n            });\n        });\n\n        var labelLayout = d3.forceSimulation(label.nodes)\n            .force(\"charge\", d3.forceManyBody().strength(-50))\n            .force(\"link\", d3.forceLink(label.links).distance(0).strength(2));\n\n        var graphLayout = d3.forceSimulation(jsondata.nodes)\n            .force(\"charge\", d3.forceManyBody().strength(-3000))\n            .force(\"center\", d3.forceCenter(width / 2, height / 2))\n            .force(\"x\", d3.forceX(width / 2).strength(1))\n            .force(\"y\", d3.forceY(height / 2).strength(1))\n            .force(\"link\", d3.forceLink(jsondata.links).id(function (d) { return d.id; }).distance(50).strength(1))\n            .on(\"tick\", ticked);\n\n        var adjlist = [];\n\n        jsondata.links.forEach(function (d) {\n            adjlist[d.source.index + \"-\" + d.target.index] = true;\n            adjlist[d.target.index + \"-\" + d.source.index] = true;\n        });\n\n        function neigh(a, b) {\n            return a == b || adjlist[a + \"-\" + b];\n        }\n\n        var svg = d3.select(d3Container.current).attr(\"width\", width).attr(\"height\", height);\n        var container = svg.append(\"g\");\n\n        svg.call(\n            d3.zoom()\n                .scaleExtent([.1, 4])\n                .on(\"zoom\", function () { container.attr(\"transform\", d3.event.transform); })\n        );\n\n        var link = container.append(\"g\").attr(\"class\", \"links\")\n            .selectAll(\"line\")\n            .data(jsondata.links)\n            .enter()\n            .append(\"line\")\n            .attr(\"stroke\", \"#aaa\")\n            .attr(\"stroke-width\", \"1px\");\n\n        var node = container.append(\"g\").attr(\"class\", \"nodes\")\n            .selectAll(\"g\")\n            .data(jsondata.nodes)\n            .enter()\n            .append(\"circle\")\n            .attr(\"r\", 5)\n            .attr(\"fill\", function (d) { return color(d.group); })\t\t\t\n            // .append('text')\n            // .attr('font-family', 'Arial')\n            // .attr('font-size', '14px')\n            // .text(function (d) { return d.fontIcon });\n\n\n        node.on(\"mouseover\", focus).on(\"mouseout\", unfocus);\n\n        node.call(\n            d3.drag()\n                .on(\"start\", dragstarted)\n                .on(\"drag\", dragged)\n                .on(\"end\", dragended)\n        );\n\n        var labelNode = container.append(\"g\").attr(\"class\", \"labelNodes\")\n            .selectAll(\"text\")\n            .data(label.nodes)\n            .enter()\n            .append(\"text\")\n            .text(function (d, i) { return i % 2 == 0 ? \"\" : d.node.id; })\n            .style(\"fill\", \"#555\")\n            .style(\"font-family\", \"Arial\")\n            .style(\"font-size\", 12)\n            .style(\"pointer-events\", \"none\"); // to prevent mouseover/drag capture\n\n        node.on(\"mouseover\", focus).on(\"mouseout\", unfocus);\n\n        function ticked() {\n\n            node.call(updateNode);\n            link.call(updateLink);\n\n            labelLayout.alphaTarget(0.3).restart();\n            labelNode.each(function (d, i) {\n                if (i % 2 == 0) {\n                    d.x = d.node.x;\n                    d.y = d.node.y;\n                } else {\n                    var b = this.getBBox();\n\n                    var diffX = d.x - d.node.x;\n                    var diffY = d.y - d.node.y;\n\n                    var dist = Math.sqrt(diffX * diffX + diffY * diffY);\n\n                    var shiftX = b.width * (diffX - dist) / (dist * 2);\n                    shiftX = Math.max(-b.width, Math.min(0, shiftX));\n                    var shiftY = 16;\n                    this.setAttribute(\"transform\", \"translate(\" + shiftX + \",\" + shiftY + \")\");\n                }\n            });\n            labelNode.call(updateNode);\n\n        }\n\n        function fixna(x) {\n            if (isFinite(x)) return x;\n            return 0;\n        }\n\n        function focus(d) {\n            var index = d3.select(d3.event.target).datum().index;\n            node.style(\"opacity\", function (o) {\n                return neigh(index, o.index) ? 1 : 0.1;\n            });\n            labelNode.attr(\"display\", function (o) {\n                return neigh(index, o.node.index) ? \"block\" : \"none\";\n            });\n            link.style(\"opacity\", function (o) {\n                return o.source.index == index || o.target.index == index ? 1 : 0.1;\n            });\n        }\n\n        function unfocus() {\n            labelNode.attr(\"display\", \"block\");\n            node.style(\"opacity\", 1);\n            link.style(\"opacity\", 1);\n        }\n\n        function updateLink(link) {\n            link.attr(\"x1\", function (d) { return fixna(d.source.x); })\n                .attr(\"y1\", function (d) { return fixna(d.source.y); })\n                .attr(\"x2\", function (d) { return fixna(d.target.x); })\n                .attr(\"y2\", function (d) { return fixna(d.target.y); });\n        }\n\n        function updateNode(node) {\n            node.attr(\"transform\", function (d) {\n                return \"translate(\" + fixna(d.x) + \",\" + fixna(d.y) + \")\";\n            });\n        }\n\n        function dragstarted(d) {\n            d3.event.sourceEvent.stopPropagation();\n            if (!d3.event.active) graphLayout.alphaTarget(0.3).restart();\n            d.fx = d.x;\n            d.fy = d.y;\n        }\n\n        function dragged(d) {\n            d.fx = d3.event.x;\n            d.fy = d3.event.y;\n        }\n\n        function dragended(d) {\n            if (!d3.event.active) graphLayout.alphaTarget(0);\n            d.fx = null;\n            d.fy = null;\n        }\n    }\n\n\n\n    /* The useRef Hook creates a variable that \"holds on\" to a value across rendering\n       passes. In this case it will hold our component's SVG DOM element. It's\n       initialized null and React will assign it later (see the return statement) */\n    const d3Container = useRef(null);\n\n    /* The useEffect Hook is for running side effects outside of React,\n       for instance inserting elements into the DOM using D3 */\n\n\n    return (\n        <svg\n            className=\"d3-component\"\n            width={400}\n            height={200}\n            ref={d3Container}\n        />\n    );\n}\n\nexport default MyD3Component;"]},"metadata":{},"sourceType":"module"}