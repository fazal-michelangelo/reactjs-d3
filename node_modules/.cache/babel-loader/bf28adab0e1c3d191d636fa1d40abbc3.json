{"ast":null,"code":"var _jsxFileName = \"/home/fazal/Documents/reactjs/inbox-pivot/src/App.js\";\nimport React, { useEffect } from 'react';\nimport logo from \"./logo.svg\";\nimport './App.css';\nimport * as d3 from 'd3';\nimport miserableJSON from '../src/miserables.json';\nconst jsondata = miserableJSON;\n\nfunction App() {\n  var width = 800;\n  var height = 600;\n  var color = d3.scaleOrdinal(d3.schemeCategory10);\n  useEffect(() => {\n    drawChart();\n  });\n\n  function drawChart() {\n    var svg = d3.select(\"#viz\").attr(\"width\", width).attr(\"height\", height);\n    var container = svg.append(\"g\");\n    var label = {\n      'nodes': [],\n      'links': []\n    };\n    jsondata.nodes.forEach(function (d, i) {\n      label.nodes.push({\n        node: d\n      });\n      label.nodes.push({\n        node: d\n      });\n      label.links.push({\n        source: i * 2,\n        target: i * 2 + 1\n      });\n    });\n    var labelLayout = d3.forceSimulation(label.nodes).force(\"charge\", d3.forceManyBody().strength(-50)).force(\"link\", d3.forceLink(label.links).distance(0).strength(2));\n    var graphLayout = d3.forceSimulation(jsondata.nodes).force(\"charge\", d3.forceManyBody().strength(-3000)).force(\"center\", d3.forceCenter(width / 2, height / 2)).force(\"x\", d3.forceX(width / 2).strength(1)).force(\"y\", d3.forceY(height / 2).strength(1)).force(\"link\", d3.forceLink(jsondata.links).id(function (d) {\n      return d.id;\n    }).distance(50).strength(1)).on(\"tick\", ticked);\n    var adjlist = [];\n    jsondata.links.forEach(function (d) {\n      adjlist[d.source.index + \"-\" + d.target.index] = true;\n      adjlist[d.target.index + \"-\" + d.source.index] = true;\n    });\n    svg.call(d3.zoom().scaleExtent([.1, 4]).on(\"zoom\", function () {\n      container.attr(\"transform\", d3.event.transform);\n    }));\n    var link = container.append(\"g\").attr(\"class\", \"links\").selectAll(\"line\").data(jsondata.links).enter().append(\"line\").attr(\"stroke\", \"#aaa\").attr(\"stroke-width\", \"1px\");\n    var node = container.append(\"g\").attr(\"class\", \"nodes\").selectAll(\"g\").data(jsondata.nodes).enter().append(\"circle\").attr(\"r\", 5).attr(\"fill\", function (d) {\n      return color(d.group);\n    });\n    node.on(\"mouseover\", focus).on(\"mouseout\", unfocus);\n    node.call(d3.drag().on(\"start\", dragstarted).on(\"drag\", dragged).on(\"end\", dragended));\n    var labelNode = container.append(\"g\").attr(\"class\", \"labelNodes\").selectAll(\"text\").data(label.nodes).enter().append(\"text\").text(function (d, i) {\n      return i % 2 == 0 ? \"\" : d.node.id;\n    }).style(\"fill\", \"#555\").style(\"font-family\", \"Arial\").style(\"font-size\", 12).style(\"pointer-events\", \"none\"); // to prevent mouseover/drag capture\n\n    node.on(\"mouseover\", focus).on(\"mouseout\", unfocus); // const data = [12, 5, 6, 6, 9, 10];  \n    // const svg = d3.select(\"body\").append(\"svg\").attr(\"width\", 700).attr(\"height\", 300);\n  }\n\n  function ticked() {\n    node.call(updateNode);\n    link.call(updateLink);\n    labelLayout.alphaTarget(0.3).restart();\n    labelNode.each(function (d, i) {\n      if (i % 2 == 0) {\n        d.x = d.node.x;\n        d.y = d.node.y;\n      } else {\n        var b = this.getBBox();\n        var diffX = d.x - d.node.x;\n        var diffY = d.y - d.node.y;\n        var dist = Math.sqrt(diffX * diffX + diffY * diffY);\n        var shiftX = b.width * (diffX - dist) / (dist * 2);\n        shiftX = Math.max(-b.width, Math.min(0, shiftX));\n        var shiftY = 16;\n        this.setAttribute(\"transform\", \"translate(\" + shiftX + \",\" + shiftY + \")\");\n      }\n    });\n    labelNode.call(updateNode);\n  }\n\n  function fixna(x) {\n    if (isFinite(x)) return x;\n    return 0;\n  }\n\n  function focus(d) {\n    var index = d3.select(d3.event.target).datum().index;\n    node.style(\"opacity\", function (o) {\n      return neigh(index, o.index) ? 1 : 0.1;\n    });\n    labelNode.attr(\"display\", function (o) {\n      return neigh(index, o.node.index) ? \"block\" : \"none\";\n    });\n    link.style(\"opacity\", function (o) {\n      return o.source.index == index || o.target.index == index ? 1 : 0.1;\n    });\n  }\n\n  function unfocus() {\n    labelNode.attr(\"display\", \"block\");\n    node.style(\"opacity\", 1);\n    link.style(\"opacity\", 1);\n  }\n\n  function updateLink(link) {\n    link.attr(\"x1\", function (d) {\n      return fixna(d.source.x);\n    }).attr(\"y1\", function (d) {\n      return fixna(d.source.y);\n    }).attr(\"x2\", function (d) {\n      return fixna(d.target.x);\n    }).attr(\"y2\", function (d) {\n      return fixna(d.target.y);\n    });\n  }\n\n  function updateNode(node) {\n    node.attr(\"transform\", function (d) {\n      return \"translate(\" + fixna(d.x) + \",\" + fixna(d.y) + \")\";\n    });\n  }\n\n  function dragstarted(d) {\n    d3.event.sourceEvent.stopPropagation();\n    if (!d3.event.active) graphLayout.alphaTarget(0.3).restart();\n    d.fx = d.x;\n    d.fy = d.y;\n  }\n\n  function dragged(d) {\n    d.fx = d3.event.x;\n    d.fy = d3.event.y;\n  }\n\n  function dragended(d) {\n    if (!d3.event.active) graphLayout.alphaTarget(0);\n    d.fx = null;\n    d.fy = null;\n  }\n\n  function neigh(a, b) {\n    return a == b || adjlist[a + \"-\" + b];\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    id: \"viz\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }\n  }));\n}\n\nexport default App;","map":{"version":3,"sources":["/home/fazal/Documents/reactjs/inbox-pivot/src/App.js"],"names":["React","useEffect","d3","miserableJSON","jsondata","App","width","height","color","scaleOrdinal","schemeCategory10","drawChart","svg","select","attr","container","append","label","nodes","forEach","d","i","push","node","links","source","target","labelLayout","forceSimulation","force","forceManyBody","strength","forceLink","distance","graphLayout","forceCenter","forceX","forceY","id","on","ticked","adjlist","index","call","zoom","scaleExtent","event","transform","link","selectAll","data","enter","group","focus","unfocus","drag","dragstarted","dragged","dragended","labelNode","text","style","updateNode","updateLink","alphaTarget","restart","each","x","y","b","getBBox","diffX","diffY","dist","Math","sqrt","shiftX","max","min","shiftY","setAttribute","fixna","isFinite","datum","o","neigh","sourceEvent","stopPropagation","active","fx","fy","a"],"mappings":"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","sourcesContent":["import React, {useEffect} from 'react';\nimport logo from './logo.svg';\nimport './App.css';\n\nimport * as d3 from 'd3';\n\nimport miserableJSON from '../src/miserables.json';\n\nconst jsondata = miserableJSON;\n\nfunction App() {\n\n\n  var width = 800;\n  var height = 600;\n  var color = d3.scaleOrdinal(d3.schemeCategory10);\n\n  \nuseEffect(() => {\n  drawChart();\n});\n\n\n\n\nfunction drawChart() {\n\n  var svg = d3.select(\"#viz\").attr(\"width\", width).attr(\"height\", height);\n  var container = svg.append(\"g\");\n\n  var label = {\n    'nodes': [],\n    'links': []\n  };\n\n  jsondata.nodes.forEach(function (d, i) {\n    label.nodes.push({ node: d });\n    label.nodes.push({ node: d });\n    label.links.push({\n      source: i * 2,\n      target: i * 2 + 1\n    });\n  });\n\n\n  var labelLayout = d3.forceSimulation(label.nodes)\n  .force(\"charge\", d3.forceManyBody().strength(-50))\n  .force(\"link\", d3.forceLink(label.links).distance(0).strength(2));\n\nvar graphLayout = d3.forceSimulation(jsondata.nodes)\n  .force(\"charge\", d3.forceManyBody().strength(-3000))\n  .force(\"center\", d3.forceCenter(width / 2, height / 2))\n  .force(\"x\", d3.forceX(width / 2).strength(1))\n  .force(\"y\", d3.forceY(height / 2).strength(1))\n  .force(\"link\", d3.forceLink(jsondata.links).id(function (d) { return d.id; }).distance(50).strength(1))\n  .on(\"tick\", ticked);\n\nvar adjlist = [];\n\njsondata.links.forEach(function (d) {\n  adjlist[d.source.index + \"-\" + d.target.index] = true;\n  adjlist[d.target.index + \"-\" + d.source.index] = true;\n});\n\n\n\nsvg.call(\n  d3.zoom()\n    .scaleExtent([.1, 4])\n    .on(\"zoom\", function () { container.attr(\"transform\", d3.event.transform); })\n);\n\n\n\n\nvar link = container.append(\"g\").attr(\"class\", \"links\")\n.selectAll(\"line\")\n.data(jsondata.links)\n.enter()\n.append(\"line\")\n.attr(\"stroke\", \"#aaa\")\n.attr(\"stroke-width\", \"1px\");\n\nvar node = container.append(\"g\").attr(\"class\", \"nodes\")\n.selectAll(\"g\")\n.data(jsondata.nodes)\n.enter()\n.append(\"circle\")\n.attr(\"r\", 5)\n.attr(\"fill\", function (d) { return color(d.group); })\n\nnode.on(\"mouseover\", focus).on(\"mouseout\", unfocus);\n\nnode.call(\nd3.drag()\n  .on(\"start\", dragstarted)\n  .on(\"drag\", dragged)\n  .on(\"end\", dragended)\n);\n\nvar labelNode = container.append(\"g\").attr(\"class\", \"labelNodes\")\n.selectAll(\"text\")\n.data(label.nodes)\n.enter()\n.append(\"text\")\n.text(function (d, i) { return i % 2 == 0 ? \"\" : d.node.id; })\n.style(\"fill\", \"#555\")\n.style(\"font-family\", \"Arial\")\n.style(\"font-size\", 12)\n.style(\"pointer-events\", \"none\"); // to prevent mouseover/drag capture\n\nnode.on(\"mouseover\", focus).on(\"mouseout\", unfocus);\n\n\n\n  // const data = [12, 5, 6, 6, 9, 10];  \n  // const svg = d3.select(\"body\").append(\"svg\").attr(\"width\", 700).attr(\"height\", 300);\n  \n}\n\nfunction ticked() {\n\n  node.call(updateNode);\n  link.call(updateLink);\n\n  labelLayout.alphaTarget(0.3).restart();\n  labelNode.each(function (d, i) {\n    if (i % 2 == 0) {\n      d.x = d.node.x;\n      d.y = d.node.y;\n    } else {\n      var b = this.getBBox();\n\n      var diffX = d.x - d.node.x;\n      var diffY = d.y - d.node.y;\n\n      var dist = Math.sqrt(diffX * diffX + diffY * diffY);\n\n      var shiftX = b.width * (diffX - dist) / (dist * 2);\n      shiftX = Math.max(-b.width, Math.min(0, shiftX));\n      var shiftY = 16;\n      this.setAttribute(\"transform\", \"translate(\" + shiftX + \",\" + shiftY + \")\");\n    }\n  });\n  labelNode.call(updateNode);\n\n}\n\n\nfunction fixna(x) {\n  if (isFinite(x)) return x;\n  return 0;\n}\n\nfunction focus(d) {\n  var index = d3.select(d3.event.target).datum().index;\n  node.style(\"opacity\", function (o) {\n    return neigh(index, o.index) ? 1 : 0.1;\n  });\n  labelNode.attr(\"display\", function (o) {\n    return neigh(index, o.node.index) ? \"block\" : \"none\";\n  });\n  link.style(\"opacity\", function (o) {\n    return o.source.index == index || o.target.index == index ? 1 : 0.1;\n  });\n}\n\nfunction unfocus() {\n  labelNode.attr(\"display\", \"block\");\n  node.style(\"opacity\", 1);\n  link.style(\"opacity\", 1);\n}\n\nfunction updateLink(link) {\n  link.attr(\"x1\", function (d) { return fixna(d.source.x); })\n    .attr(\"y1\", function (d) { return fixna(d.source.y); })\n    .attr(\"x2\", function (d) { return fixna(d.target.x); })\n    .attr(\"y2\", function (d) { return fixna(d.target.y); });\n}\n\nfunction updateNode(node) {\n  node.attr(\"transform\", function (d) {\n    return \"translate(\" + fixna(d.x) + \",\" + fixna(d.y) + \")\";\n  });\n}\n\nfunction dragstarted(d) {\n  d3.event.sourceEvent.stopPropagation();\n  if (!d3.event.active) graphLayout.alphaTarget(0.3).restart();\n  d.fx = d.x;\n  d.fy = d.y;\n}\n\nfunction dragged(d) {\n  d.fx = d3.event.x;\n  d.fy = d3.event.y;\n}\n\nfunction dragended(d) {\n  if (!d3.event.active) graphLayout.alphaTarget(0);\n  d.fx = null;\n  d.fy = null;\n}\n\n\n\nfunction neigh(a, b) {\n  return a == b || adjlist[a + \"-\" + b];\n}\n\n  return (\n    <div className=\"App\">\n      <svg id='viz'></svg>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}